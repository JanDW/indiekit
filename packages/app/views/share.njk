{% extends "_form.njk" %}

{% set title = "Share" %}

{% block content %}
<div class="preview">
  <h3 class="preview__title">
    <output for="title" id="title-preview">{{ title }}</output>
  </h3>
  <p class="preview__content">
    <output for="content" id="content-preview">{{ content }}</output>
  </p>
  <p class="preview__date">
    <date>{{ "now" | date("fff") }}</date>
  </p>
</div>

<div class="field">
  <label class="field__label" for="title">{{ __("Title") }}</label>
  <input class="field__input" id="title" value="{{ name }}" name="name"/>
</div>

<div class="field">
  <label class="field__label" for="url">{{ __("URL") }}</label>
  <input class="field__input" id="url" value="{{ url }}" name="bookmark-of"/>
</div>

<div class="field">
  <label class="field__label" for="content">{{ __("Content") }}</label>
  <textarea class="field__input" id="content" name="content" rows="5">{{ content }}</textarea>
</div>

<input type="hidden" name="access_token" value="{{ session.indieauthToken }}"/>
<input type="hidden" name="h" value="entry"/>
<button class="button" type="submit" formaction="/micropub">{{ __("Publish") }}</button>
{% endblock %}

{% block scripts %}
<script>
  let share = document.querySelector('.form');
  let title = document.getElementById('title');
  let titlePreview = document.querySelector('output[for="title"]');
  let content = document.getElementById('content');
  let contentPreview = document.querySelector('output[for="content"]');
  share.oninput = handleInput;
  function handleInput(e) {
    titlePreview.value = decodeURIComponent(title.value);
    contentPreview.value = content.value;
  }
</script>
{% endblock %}
